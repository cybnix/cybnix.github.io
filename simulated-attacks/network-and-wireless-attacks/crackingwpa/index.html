<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.769702421457">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>Cracking WPA/WPA2</title>
    <meta name="title" content="Cracking WPA/WPA2">
    <meta name="description" content="In this post, I will explore how to conduct a simulated WiFi attack on a test network to understand how credentials can be stolen and used to gain...">

    <!-- Canonical -->
    <link rel="canonical" href="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/crackingwpa/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/crackingwpa/">
    <meta property="og:title" content="Cracking WPA/WPA2">
    <meta property="og:description" content="In this post, I will explore how to conduct a simulated WiFi attack on a test network to understand how credentials can be stolen and used to gain...">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/crackingwpa/">
    <meta property="twitter:title" content="Cracking WPA/WPA2">
    <meta property="twitter:description" content="In this post, I will explore how to conduct a simulated WiFi attack on a test network to understand how credentials can be stolen and used to gain...">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../resources/css/retype.css?v=3.5.0.769702421457" rel="stylesheet">

    <script data-cfasync="false" src="../../../resources/js/config.js?v=3.5.0.769702421457" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../resources/js/lunr.js?v=3.5.0.769702421457" data-turbo-eval="false" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../" class="flex items-center leading-snug text-xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Cybnix <span class="docs-emoji">&#x26A1;</span><span class="docs-emoji">&#x1F468;</span>‚Äç<span class="docs-emoji">&#x1F4BB;</span></span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/nikolay-ivanov-5818b5144">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M3.5 8a5.5 5.5 0 1 1 8.596 4.547 9.005 9.005 0 0 1 5.9 8.18.751.751 0 0 1-1.5.045 7.5 7.5 0 0 0-14.993 0 .75.75 0 0 1-1.499-.044 9.005 9.005 0 0 1 5.9-8.181A5.496 5.496 0 0 1 3.5 8ZM9 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm8.29 4c-.148 0-.292.01-.434.03a.75.75 0 1 1-.212-1.484 4.53 4.53 0 0 1 3.38 8.097 6.69 6.69 0 0 1 3.956 6.107.75.75 0 0 1-1.5 0 5.193 5.193 0 0 0-3.696-4.972l-.534-.16v-1.676l.41-.209A3.03 3.03 0 0 0 17.29 8Z"/>
                                        </g>
                                    </svg>
                                    <span>LinkedIn</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/nikolay-ivanov-5818b5144">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M3.5 8a5.5 5.5 0 1 1 8.596 4.547 9.005 9.005 0 0 1 5.9 8.18.751.751 0 0 1-1.5.045 7.5 7.5 0 0 0-14.993 0 .75.75 0 0 1-1.499-.044 9.005 9.005 0 0 1 5.9-8.181A5.496 5.496 0 0 1 3.5 8ZM9 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm8.29 4c-.148 0-.292.01-.434.03a.75.75 0 1 1-.212-1.484 4.53 4.53 0 0 1 3.38 8.097 6.69 6.69 0 0 1 3.956 6.107.75.75 0 0 1-1.5 0 5.193 5.193 0 0 0-3.696-4.972l-.534-.16v-1.676l.41-.209A3.03 3.03 0 0 0 17.29 8Z"/>
                                                </g>
                                            </svg>
                                            <span>LinkedIn</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="cracking-wpawpa2" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cracking-wpawpa2">#</doc-anchor-trigger>
        <span>Cracking WPA/WPA2</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="introduction">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#introduction">#</doc-anchor-trigger>
        <span>Introduction</span>
    </h2>
</doc-anchor-target>
<img src="/static/bird1.jpg" style="border-radius: 10px;"/>
<p>In this post, I will explore how to conduct a simulated WiFi attack on a test network to understand how credentials can be stolen and used to gain unauthorized access. The goal is to learn about the dangers of such attacks and how they can affect us. I will be using my Kali Linux laptop which I have for testing purposes, however the tools I am using are available for other operating systems as well. They come preinstalled in Kali which is why I prefer using it.</p>
<p>While there are many resources available on this topic, I wanted to present it in my own way for better clarity and understanding, and to have it as a future reference for myself as well <span class="docs-emoji">&#x1F607;</span>.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-yellow-500"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-yellow-500" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M22.48 15.59L14.01 1.45A2.968 2.968 0 0012.16.09c-.78-.19-1.58-.07-2.27.35-.41.25-.76.6-1.01 1.01v.01L.4 15.6c-.83 1.43-.33 3.27 1.1 4.1.45.26.95.4 1.48.4h16.95c.8-.01 1.55-.33 2.11-.9.56-.57.87-1.33.86-2.13a3.04 3.04 0 00-.42-1.48zm-1.87 2.21c-.19.19-.44.3-.69.3H2.99c-.17 0-.34-.05-.49-.13a.992.992 0 01-.37-1.35L10.6 2.48c.08-.14.2-.25.34-.33a.992.992 0 011.37.33l8.46 14.13c.09.15.13.32.13.49 0 .26-.1.51-.29.7z"></path>
                    <path d="M11.45 12.1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 .56.45 1 1 1zM11.46 14.1c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>Please remember, never perform these actions on networks you do not own or have explicit permission to test.</p>
        </div>
    </div>
</div>
<doc-anchor-target id="we-need-to-put-our-wireless-interface-in-monitor-mode-first">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#we-need-to-put-our-wireless-interface-in-monitor-mode-first">#</doc-anchor-trigger>
        <span>We need to put our wireless interface in monitor mode first</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="whats-monitor-mode-why-do-we-need-that">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#whats-monitor-mode-why-do-we-need-that">#</doc-anchor-trigger>
        <span>What&#x27;s monitor mode? Why do we need that?</span>
    </h4>
</doc-anchor-target>
<p>Monitor mode would allow our WiFi card to listen to all wireless trafic and not just the data addressed to us. This is essential for capturing important information like the WPA/WPA2 handshake for example, which we will show later.</p>
<doc-anchor-target id="do-all-adapters-support-monitor-mode">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#do-all-adapters-support-monitor-mode">#</doc-anchor-trigger>
        <span>Do all adapters support monitor mode?</span>
    </h4>
</doc-anchor-target>
<p>Nope! It really depends on the hardware and the driver of the adapter. Before proceeding, it&#x27;s good to check if your WiFi adapter is compatible. Many people use external USB adapters that support monitor mode, and there are some really cheap ones available online. You can find a lot of information about compatible adapters, but I suggest looking into the following resources : <a href="https://github.com/morrownr/USB-WiFi/blob/main/home/USB_WiFi_Chipsets.md" class="no-link inline-flex align-middle items-center font-medium cursor-pointer transition-colors duration-200 ease-out focus:outline-none bg-green-500 hover:bg-green-700 text-white px-4 h-10 text-sm rounded-full">
    <span>Github</span>
</a> <a href="https://www.wirelesshack.org/best-kali-linux-compatible-usb-adapter-dongles.html" class="no-link inline-flex align-middle items-center font-medium cursor-pointer transition-colors duration-200 ease-out focus:outline-none bg-green-500 hover:bg-green-700 text-white px-4 h-10 text-sm rounded-full">
    <span>Wirelesshack</span>
</a></p>
<p>I have one really old laptop that luckily has an adapter (Atheros AR9485) that supports it and I use it for testing. I also have one external adapter which I got for around $10 some time ago but I won&#x27;t be using it for the current post, maybe at a later stage <span class="docs-emoji">&#x1F60E;</span>.</p>
<doc-anchor-target id="putting-my-adapter-into-monitor-mode">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#putting-my-adapter-into-monitor-mode">#</doc-anchor-trigger>
        <span>Putting my adapter into monitor mode</span>
    </h4>
</doc-anchor-target>
<img src="/static/airmon1.png" style="border-radius: 10px;"/>
<p>First we can see that our adapter is &quot;wlan0&quot; after using &quot;iwconfig&quot; and it is in Mode: Managed.</p>
<img src="/static/airmon2.png" style="border-radius: 10px;"/>
<p>Now after using <strong>sudo airmon-ng start wlan0</strong> we can see how the adapter changed its name to &quot;wlan0mon&quot; and its mode to &quot;Montior&quot;.</p>
<p>That&#x27;s it. Quite simple isn&#x27;t it? Now our adapter can capture the needed information.</p>
<hr>
<doc-anchor-target id="capturing-the-4-way-authentication-handshake">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#capturing-the-4-way-authentication-handshake">#</doc-anchor-trigger>
        <span>Capturing the 4-way authentication handshake</span>
    </h2>
</doc-anchor-target>
<blockquote>
<p>If  you don&#x27;t know what 4-way handshake is, this is simply the series of messages that are being exchanged between your device and the network so a secure connection can be established. While it is designed for a secure authentication, we can still capture that and we can attempt to crack it which can lead to us gaining unauthorized access to the network. <span class="docs-emoji">&#x1F916;</span></p>
</blockquote>
<doc-anchor-target id="scan-for-the-target">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#scan-for-the-target">#</doc-anchor-trigger>
        <span>Scan for the target</span>
    </h3>
</doc-anchor-target>
<img src="/static/airodump-ng.png" style="border-radius: 10px;"/>
<p>We should now use <strong>sudo airodump-ng wlan0mon</strong>. This would show us the nearby networks and some details related to them. As you can see on the above screenshot, we have identified our target and we know which channel it uses + its MAC address as well.</p>
<doc-anchor-target id="select-the-target-and-capture-the-handshake">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#select-the-target-and-capture-the-handshake">#</doc-anchor-trigger>
        <span>Select the target and capture the handshake</span>
    </h3>
</doc-anchor-target>
<p>Next, we need to capture the handshake from our target WiFi network. To do this, we&#x27;ll use the airodump-ng command. In this example, we&#x27;re targeting a network on channel 7 with a specific BSSID (32:DE:4B:47:85:8F). The captured data will be saved to the desktop and then we can continue further.</p>
<blockquote>
<p><strong>sudo airodump-ng -c 7 -w /home/user/Desktop/capture -d 32:DE:4B:47:85:8F wlan0mon</strong></p>
</blockquote>
<blockquote>
<ul>
<li><em><strong>-c</strong></em> we select the channel of the network we would like to attack</li>
<li><em><strong>-w</strong></em> the path of our capture file</li>
<li><em><strong>-d</strong></em> MAC address of the access point</li>
<li><em><strong>wlan0mon</strong></em> our adapter which is now in monitor mode</li>
<li><em><strong>We got all the above information from our first step which was to scan the nearby networks.</strong></em></li>
</ul>
</blockquote>
<img src="/static/airodump-ng-listen.png" style="border-radius: 10px;"/>
<p>Now we will see the above window after executing the command. Once a device tries to connect to the AP, we will capture the handshake.</p>
<doc-anchor-target id="but-what-if-there-are-no-devices-that-want-to-connect-to-the-network-at-the-current-moment">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#but-what-if-there-are-no-devices-that-want-to-connect-to-the-network-at-the-current-moment">#</doc-anchor-trigger>
        <span>But what if there are no devices that want to connect to the network at the current moment?</span>
    </h3>
</doc-anchor-target>
<p>We can easily force the ones that are already connected to try to reconnnect to the access point and then we can capture the handshake.<span class="docs-emoji">&#x1F609;</span></p>
<p>We will send some messages to the clients, which are basically going to tell them that they are no longer associated with this access point. This will make them try to reconnect and it would let us capture the handshake.</p>
<doc-anchor-target id="executing-a-deauthentitcation-attack">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#executing-a-deauthentitcation-attack">#</doc-anchor-trigger>
        <span>Executing a deauthentitcation attack</span>
    </h3>
</doc-anchor-target>
<p>First we will connect the &quot;victim&quot; to the test network which we are using for the attack.</p>
<img src="/static/client.jpg" style="border-radius: 10px;"/>
<p>Now that we have the needed details from the first scan we can proceed further with the following command :</p>
<blockquote>
<p><strong>sudo aireplay-ng --deauth 0 -a 32:DE:4B:47:85:8F wlan0mon</strong></p>
</blockquote>
<blockquote>
<ul>
<li><em><strong>aireplay-ng</strong></em> this tool is a part of the aircrack-ng suite as well as the other which we have used so far</li>
<li><em><strong>--deauth 0</strong></em> this specifies that we want to do a deauthentication attack, 0 simply means that packets will be sent until manually stopped</li>
<li><em><strong>-a</strong></em> MAC address of the access point</li>
<li><em><strong>wlan0mon</strong></em> our adapter which is now in monitor mode</li>
<li><em><strong>With an additional flag &quot;-c&quot; we can specify a client that we want to deauth from the network. You will usually get a list of the clients on the previous steps but in our case we will just do it without it as our test network has only 1 device connected to it. As you can see in the disclaimer on the below screenshot, it is said that this attack is more effective if we specifically target a client that is connected to the network.</strong></em></li>
</ul>
</blockquote>
<img src="/static/deauth1.png" style="border-radius: 10px;"/>
<p>Now what happens after executing this attack is that our phone got disconnected from the network. When we stop the deauth attack, the phone will automatically connect back and in the window where we are waiting for the handshake, we will see a sign that it is collected.</p>
<img src="/static/handshake.png" style="border-radius: 10px;"/>
<br/><br/>
Now we don't even need to be close to the network as the cracking process can be done offline as we got the capture file on our desktop.
<img src="/static/capture.png" style="border-radius: 10px;"/>
<hr>
<doc-anchor-target id="cracking-the-handshake">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cracking-the-handshake">#</doc-anchor-trigger>
        <span>Cracking the handshake</span>
    </h2>
</doc-anchor-target>
<p>Now that we got the .cap file that contains the handshake, we can try to crack it.</p>
<img src="/static/rockyou.png" style="border-radius: 10px;"/>
<br/><br/>
<blockquote>
<p><strong>sudo aircrack-ng capture-01.cap -w /usr/share/wordlists/rockyou.txt</strong></p>
<ul>
<li>We just have to use aircrack-ng, the .cap file and a wordlist. In this case you can see that I am using &quot;rockyou.txt&quot; which is a wordlist included in Kali Linux. You can use whatever you like as a lot of wordlists are widely available on the internet. Or you can maybe even generate one yourself. Thinking about it, I might create a simple guide for that in the future <span class="docs-emoji">&#x1F60E;</span>.</li>
</ul>
</blockquote>
<img src="/static/cracked.png" style="border-radius: 10px;"/>
<p>As you can see, after we have executed the command it took only 6 seconds to crack this password. Aircrack uses each password in our wordlist as a key to attempt to decrypt the encrypted handshake information.</p>
<img src="/static/pass.png" style="border-radius: 10px;"/>
<br/><br/> 
<img src="/static/wifi.png" style="border-radius: 10px;"/>
<p>And as you can observe above, we were able to connect to this network with the provided password.</p>
<hr>
<doc-anchor-target id="opening-the-cap-file-in-wireshark-to-see-each-step-of-the-handshake">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#opening-the-cap-file-in-wireshark-to-see-each-step-of-the-handshake">#</doc-anchor-trigger>
        <span>Opening the .cap file in Wireshark to see each step of the handshake</span>
    </h2>
</doc-anchor-target>
<p>If you find it interesting, you can open this .cap file with Wireshark. That way you can observe the authentication process between the client and the AP. You can see the individual hanshake messages which have been exchanged during the authentication process.</p>
<p>It&#x27;s very straightforward, all you have to do is open Wireshark, open the file :
<img src="/static/wireshark1.png" style="border-radius: 10px;"/></p>
<p>Next filter for &quot;eapol&quot; (Extensible Authentication Protocol over LAN) packets. When a device tries to connect to a WiFi network, it needs to prove its identity to the access point (the router). EAPOL packets are like the &#x27;handshake&#x27; between the device and the access point during this authentication process.</p>
<img src="/static/wireshark2.png" style="border-radius: 10px;"/>
<hr>
<doc-anchor-target id="protecting-yourself">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#protecting-yourself">#</doc-anchor-trigger>
        <span>Protecting yourself</span>
    </h2>
</doc-anchor-target>
<p>A few tips that I follow to protect myself :</p>
<dl>
<dt><strong>Strong password</strong></dt>
<dd>I would say that this is a must. Make sure the password combines uppercase with lowercase letters, numbers and even special characters. It would be significantly harder to crack one as it is going to be more resistant to dictionary-based attacks. Plus I wouldn&#x27;t use any common words <span class="docs-emoji">&#x1F601;</span></dd>
<dt><strong>Enable WPA3</strong></dt>
<dd>WPA3 provides stronger encryption and authentication protocols compared to previous standards like WPA and WPA2 (had to downgrade mine to WPA2 for the simulation <span class="docs-emoji">&#x1F604;</span>). It introduces the Simultaneous Authentication of Equals (SAE) protocol, which protects against various types of attacks, including brute-force and dictionary attacks.</dd>
<dt><strong>MAC Address Filtering</strong></dt>
<dd>Restrict the access to your WiFi network by only allowing devices with specific MAC addresses to connect to it. Yes a MAC address can definitely be spoofed but in my opinion it would add an additional barrier. I would like to make it as annoying as possilble if anyone is attempting to breach into my home network <span class="docs-emoji">&#x1F609;</span>.</dd>
</dl>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../simulated-attacks/bee-box/test/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">test</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Cracking WPA/WPA2", level: 3, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
