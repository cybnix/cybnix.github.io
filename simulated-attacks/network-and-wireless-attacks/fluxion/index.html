<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.5.0.771157918128">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.5.0">

    <!-- Primary Meta Tags -->
    <title>MITM WPA/WPA2 attack - Fluxion</title>
    <meta name="title" content="MITM WPA/WPA2 attack - Fluxion">
    <meta name="description" content="In this post I will be simulating an attack with Fluxion on my own test network at home.">

    <!-- Canonical -->
    <link rel="canonical" href="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/fluxion/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/fluxion/">
    <meta property="og:title" content="MITM WPA/WPA2 attack - Fluxion">
    <meta property="og:description" content="In this post I will be simulating an attack with Fluxion on my own test network at home.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://cybnix.github.io/simulated-attacks/network-and-wireless-attacks/fluxion/">
    <meta property="twitter:title" content="MITM WPA/WPA2 attack - Fluxion">
    <meta property="twitter:description" content="In this post I will be simulating an attack with Fluxion on my own test network at home.">

    <script data-cfasync="false">(function () { var el = document.documentElement, m = localStorage.getItem("doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="../../../resources/css/retype.css?v=3.5.0.771157918128" rel="stylesheet">

    <script data-cfasync="false" src="../../../resources/js/config.js?v=3.5.0.771157918128" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../../resources/js/retype.js?v=3.5.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../../resources/js/lunr.js?v=3.5.0.771157918128" data-turbo-eval="false" defer></script>
</head>
<body>
    <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
        <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>
    
        <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="docs-sidebar-toggle"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="docs-site-logo" href="../../../" class="flex items-center leading-snug text-xl">
                            <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Cybnix <span class="docs-emoji">&#x1F468;</span>‍<span class="docs-emoji">&#x1F4BB;</span></span>
                        </a>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/nikolay-ivanov-5818b5144">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M3.5 8a5.5 5.5 0 1 1 8.596 4.547 9.005 9.005 0 0 1 5.9 8.18.751.751 0 0 1-1.5.045 7.5 7.5 0 0 0-14.993 0 .75.75 0 0 1-1.499-.044 9.005 9.005 0 0 1 5.9-8.181A5.496 5.496 0 0 1 3.5 8ZM9 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm8.29 4c-.148 0-.292.01-.434.03a.75.75 0 1 1-.212-1.484 4.53 4.53 0 0 1 3.38 8.097 6.69 6.69 0 0 1 3.956 6.107.75.75 0 0 1-1.5 0 5.193 5.193 0 0 0-3.696-4.972l-.534-.16v-1.676l.41-.209A3.03 3.03 0 0 0 17.29 8Z"/>
                                        </g>
                                    </svg>
                                    <span>LinkedIn</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <!-- Header Right Skeleton -->
                    <div v-cloak class="flex justify-end grow skeleton">
        
                        <!-- Search input mock -->
                        <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                            <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                                <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                            </div>
                            <input class="w-full h-10 placeholder-gray-400 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 dark:placeholder-dark-400" style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search">
                        </div>
        
                        <!-- Mobile search button -->
                        <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                        </div>
        
                        <!-- Dark mode switch placeholder -->
                        <div class="w-10 h-10 lg:ml-2"></div>
        
                        <!-- History button -->
                        <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" class="shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                        </div>
                    </div>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="docs-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
        <div class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">
            
                <!-- Render this div, if config.showSidebarFilter is `true` -->
                <div class="flex items-center h-16 px-6">
                    <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                    <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-dark-650">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://www.linkedin.com/in/nikolay-ivanov-5818b5144">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M3.5 8a5.5 5.5 0 1 1 8.596 4.547 9.005 9.005 0 0 1 5.9 8.18.751.751 0 0 1-1.5.045 7.5 7.5 0 0 0-14.993 0 .75.75 0 0 1-1.499-.044 9.005 9.005 0 0 1 5.9-8.181A5.496 5.496 0 0 1 3.5 8ZM9 4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Zm8.29 4c-.148 0-.292.01-.434.03a.75.75 0 1 1-.212-1.484 4.53 4.53 0 0 1 3.38 8.097 6.69 6.69 0 0 1 3.956 6.107.75.75 0 0 1-1.5 0 5.193 5.193 0 0 0-3.696-4.972l-.534-.16v-1.676l.41-.209A3.03 3.03 0 0 0 17.29 8Z"/>
                                                </g>
                                            </svg>
                                            <span>LinkedIn</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 dark:bg-dark-850">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="docs-markdown" id="docs-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="docs-sidebar-right-toggle"></div>
                                <!-- Page content  -->
<doc-anchor-target id="mitm-wpawpa2-attack---fluxion" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#mitm-wpawpa2-attack---fluxion">#</doc-anchor-trigger>
        <span>MITM WPA/WPA2 attack - Fluxion</span>
    </h1>
</doc-anchor-target>
<hr>
<doc-anchor-target id="introduction">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#introduction">#</doc-anchor-trigger>
        <span>Introduction</span>
    </h2>
</doc-anchor-target>
<img src="/static/parrot.jpg" style="border-radius: 30px; width: 100%;"/>
<br><br>
<p>In this post I will be simulating an attack with Fluxion on my own test network at home. The goal is to present how we can simulate a rogue access point, tricking unsuspecting users into revelaling their WiFi credentials to us. If a hacker cannot crack your handshake, he can use tools like fluxion that are using social engineering to steal a password. I will be using my laptop which I have used in <a href="/simulated-attacks/network-and-wireless-attacks/crackingwpa">Cracking WPA/WPA2</a>. If you want more information on adapters you can check that post as I have shared some details there.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1 rounded-tl rounded-bl bg-yellow-500"></div>
    <div class="flex w-full py-4 border border-l-0 border-gray-300 rounded-tr rounded-br doc-alert bg-white dark:bg-dark-700 dark:border-dark-700" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-yellow-500" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M22.48 15.59L14.01 1.45A2.968 2.968 0 0012.16.09c-.78-.19-1.58-.07-2.27.35-.41.25-.76.6-1.01 1.01v.01L.4 15.6c-.83 1.43-.33 3.27 1.1 4.1.45.26.95.4 1.48.4h16.95c.8-.01 1.55-.33 2.11-.9.56-.57.87-1.33.86-2.13a3.04 3.04 0 00-.42-1.48zm-1.87 2.21c-.19.19-.44.3-.69.3H2.99c-.17 0-.34-.05-.49-.13a.992.992 0 01-.37-1.35L10.6 2.48c.08-.14.2-.25.34-.33a.992.992 0 011.37.33l8.46 14.13c.09.15.13.32.13.49 0 .26-.1.51-.29.7z"></path>
                    <path d="M11.45 12.1c.55 0 1-.45 1-1v-4c0-.55-.45-1-1-1s-1 .45-1 1v4c0 .56.45 1 1 1zM11.46 14.1c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>Please remember, never perform these actions on networks you do not own or have explicit permission to test.</p>
        </div>
    </div>
</div>
<hr>
<doc-anchor-target id="we-need-to-start-our-fluxion-first">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#we-need-to-start-our-fluxion-first">#</doc-anchor-trigger>
        <span>We need to start our fluxion first</span>
    </h2>
</doc-anchor-target>
<p>If you want to find out how to configure your fluxion I recommend checking my guide for that - <a href="/guides/eh-tools-and-utilities/fluxion_install">Fluxion Setup</a></p>
<p>When we first start our fluxion we are first presented with a language option to select :
<img src="/static/fluxion/fluxion4.png" style="border-radius: 10px; width: 80%;"/></p>
<p>After we select the language, we need to select another option. We have 2 of them, one is to create a Captive Portal or an &quot;evil twin&quot; where the victim will connect and the other one is a Handshake Snooper. So in order to create an evil twin, we need to first use the Handshake Snooper as we need the handshake because it will be used later for password verification (don&#x27;t worry everything is semi-automated here so it&#x27;s quite easy to do).</p>
<img src="/static/fluxion/fluxion5.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<hr>
<doc-anchor-target id="capturing-the-handshake">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#capturing-the-handshake">#</doc-anchor-trigger>
        <span>Capturing the handshake</span>
    </h2>
</doc-anchor-target>
<p>We need to select a channel now, I will go with All channels (2.4GHz). In our case I know that my TestNetwork is 2.4GHz (7 channel) as I have configured it that way. There is a device already connected to it so it should be quite easy to get the handshake.</p>
<img src="/static/fluxion/fluxion6.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>A scan will pop up so after we see our targeted network populated, we will stop the scan and select the network - in our case <strong>TestNetwork</strong>.</p>
<img src="/static/fluxion/fluxion7.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Now we need to select the interface which will be using. In my case I have only 1 which is my internal adapter.</p>
<img src="/static/fluxion/fluxion8.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Now as I did in <a href="/simulated-attacks/network-and-wireless-attacks/crackingwpa">Cracking WPA/WPA2</a>, I will deauthenticate the devices on this network to speed up the process so I will go with the third option. I am going with it as I have had more success with the mdk4 method of deauthentication.</p>
<img src="/static/fluxion/fluxion9.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Now we need to select a method of verification for the hash. Fluxion seems to be recommending cowpatty so let&#x27;s try that.
<img src="/static/fluxion/fluxion10.png" style="border-radius: 10px; width: 80%;"/></p>
<p>Will go with every 30 seconds, want to speed it up a bit.
<img src="/static/fluxion/fluxion11.png" style="border-radius: 10px; width: 80%;"/></p>
<p>Now we will go with Asynchronous verification. What does that mean? The difference between the two is that during the Asynchronous verification, multiple verifications processes run in parallel, which can make the attack faster. In synchronous however, processes run one after the other in a sequence, which would be slower.
<img src="/static/fluxion/fluxion12.png" style="border-radius: 10px; width: 80%;"/></p>
<p>A few windows will pop up showing you the processess that are happening and one of them being the deauth packets being sent. So what happened is that my phone which was connected to the network got disconnected and upon trying to connect back again automatically, the handshake was captured.</p>
<img src="/static/fluxion/fluxion13.png" style="border-radius: 10px; width: 80%;"/>
<img src="/static/fluxion/fluxion13-1.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<hr>
<doc-anchor-target id="creating-an-evil-twin-with-the-captured-handshake">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#creating-an-evil-twin-with-the-captured-handshake">#</doc-anchor-trigger>
        <span>Creating an evil twin with the captured handshake</span>
    </h2>
</doc-anchor-target>
<p>Now as we have it saved to the fluxion&#x27;s database, we can go back and do another attack, which is the Captive Portal.
<img src="/static/fluxion/fluxion14.png" style="border-radius: 10px; width: 80%;"/></p>
<p>Again, we have to do the scan and select our test network.
<img src="/static/fluxion/fluxion15.png" style="border-radius: 10px; width: 80%;"/></p>
<p>Once again, we will select our adapter as it will be needed to create that &quot;evil&quot; access point.
<img src="/static/fluxion/fluxion16.png" style="border-radius: 10px; width: 80%;"/>
<img src="/static/fluxion/fluxion17.png" style="border-radius: 10px; width: 80%;"/></p>
<p>Then we have to select our method of authentication, which will be used to deauthenticate the devices on the network while spawning the evil access point. We will go with mdk4 again.</p>
<img src="/static/fluxion/fluxion18.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Next step is to pick a tool for the AP. We will go with hostapd as I&#x27;ve read it is more stable and can handle multiple connections. (I&#x27;ve tested it with 2 phones and it really did handle them)</p>
<img src="/static/fluxion/fluxion19.png" style="border-radius: 10px; width: 80%;"/>
<p>As in one of the previous steps, we will go again with cowpatty that will be our password verification method, which will basically compare the user key to the handshake. So here comes the question what happens if the user types a wrong password on the fake AP? Well the tool will compare the password to the handshake which we have captured earlier so if the password is not correct, the user will continue to be prompted. In case the password is correct, the AP will shutdown and everything will go back to normal so the user won&#x27;t find out that he was basically tricked.</p>
<img src="/static/fluxion/fluxion20.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Now we will use the hash that we have captured earlier for the evil twin AP. [1]</p>
<img src="/static/fluxion/fluxion21.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>As in the previous step we will use the hash verification to be cowpatty (will stick to it as it is recommended).</p>
<img src="/static/fluxion/fluxion22.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Next step is to generate a captive portal. Basically this portal will look very real and once the user connects to the fake AP, he will be presented a portal which will bait him to type in the network password. We will create an SSL certificate so it looks more legit.</p>
<img src="/static/fluxion/fluxion23.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>At this step we will use the &quot;disconnected&quot; which won&#x27;t provide access to the internet to our victim once he connects to our fake AP.
<img src="/static/fluxion/fluxion24.png" style="border-radius: 10px; width: 80%;"/></p>
<p>This part is really, really cool. We can select from a ton of interfaces for a bait. I will go with a Generic one in Bulgarian language for this test. There are 79 different portal versions currently.</p>
<img src="/static/fluxion/fluxion25.png" style="border-radius: 10px; width: 80%;"/>
<br><br>
<p>Now what we see are a bunch of windows doing different things. There is a DNS server, redirecting all request to the attacker&#x27;s host portal. A web server that is serving the portal to the victim. Also we got a jammer (the red one) that will continue sending deauth requests to drop all clients from the original AP. So what will happen now is tht all authentication attempts at the fake portal will be checked against the handshake we got earlier. Once everything is ready, all services will be terminated nd we will get the key.</p>
<img src="/static/fluxion/fluxion26.png" style="border-radius: 10px; width: 100%;"/>
<br><br>
<p>Now we wait.</p>
<hr>
<doc-anchor-target id="what-happens-next-when-the-victim-connects">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#what-happens-next-when-the-victim-connects">#</doc-anchor-trigger>
        <span>What happens next when the victim connects?</span>
    </h2>
</doc-anchor-target>
<p>From the perspective of our victim, we can see the following - 2 networks with the same name, the first one is unlocked (evil twin one) and the victim is not able to connect to the second one (the real network) as it is being deauthenticated constantly:</p>
<img src="/static/fluxion/phone1.png" style="border-radius: 10px; width: 30%;"/>
<br><br>
<p>The victim will be redirected into the browser to our fake portal page. So basically this message tells the victim that for security reasons, it is needed to enter the password to gain access to the internet.</p>
<img src="/static/fluxion/phone2.png" style="border-radius: 10px; width: 30%;"/>
<br><br>
<p>Now as the victim enters the password a message appears that the connection will be recovered in a few seconds.</p>
<img src="/static/fluxion/phone3.png" style="border-radius: 10px; width: 30%;"/>
<hr>
<doc-anchor-target id="getting-the-password-on-our-end">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#getting-the-password-on-our-end">#</doc-anchor-trigger>
        <span>Getting the password on our end</span>
    </h2>
</doc-anchor-target>
<p>So when the victim connected to our rogue AP first, we have noticed that in some of the terminal windows that have appeared. It looks like that the victim is being redirected to the portal and we can see it on the DNS Service and Web Service windows.
<img src="/static/fluxion/fluxion29.png" style="border-radius: 10px; width: 60%;"/></p>
<p>Once the victim entered the password in the fake portal, a window appeared that told us where the password got saved.
<img src="/static/fluxion/fluxion30.png" style="border-radius: 10px; width: 70%;"/></p>
<p>And there we have it.</p>
<img src="/static/fluxion/fluxion31.png" style="border-radius: 10px; width: 70%;"/>
<hr>
<doc-anchor-target id="conclusion">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#conclusion">#</doc-anchor-trigger>
        <span>Conclusion</span>
    </h2>
</doc-anchor-target>
<p>The goal of this simulation was to present how vulnerable we can be to targeted attacks. By creating a rogue access point, attackers can trick people into revealing their WiFi passwords, which will grant them unauthorized access to the network. It&#x27;s very important for us to understand how those methods work so we can recognize such an attack.</p>
<p>Always enable WP3 encryption if supported. It offers stronger security features that can protect against many common attacks.</p>
<p>Regularly update all of your devices including the firmware of your router. For example I have tried to connect to this network from one phone which has the latest updates and it didn&#x27;t work. However I have tested 2 other phones which have not been updated in a while and guess what? Both of them were able to connect to the evil twin network.</p>
<p>Believe me, such an attack can easily work in real life, especially if the victims are people who are not aware of these types of security threats.</p>
<p>Stay informed, stay secure and be sure to inform the people around you. <span class="docs-emoji">&#x1F60E;</span></p>

                                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer class="clear-both">
                            
                                <nav class="flex mt-14">
                                    <div class="w-1/2">
                                        <a class="px-5 py-4 h-full flex items-center break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r rounded-l-lg transition-colors duration-150 relative hover:z-5" href="../../../simulated-attacks/network-and-wireless-attacks/crackingwpa/">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
                                            <span>
                                                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                                                <span class="block mt-1">Cracking WPA/WPA​2</span>
                                            </span>
                                        </a>
                                    </div>
                            
                                    <div class="w-1/2">
                                    </div>
                                </nav>
                            </footer>
                        </main>
                
                        <div class="border-t dark:border-dark-650 pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between">
                                <div>
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="docs-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "MITM WPA/WPA2 attack - Fluxion", level: 3, icon: "file", hasPrism: false, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
